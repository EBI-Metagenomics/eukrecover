manifest {
    nextflowVersion = '!>=21.10.0'
    mainScript = "main.nf"
}

params {
    outdir                                = "GGP_pipeline_results"
    publish_dir_mode                      = 'copy'
    // qc params
    shortread_qc_mergepairs              = false
    // binning params
    min_contig_size                      = 1500
    metabat_rng_seed                     = 1
    skip_maxbin2                         = false
    skip_metabat2                        = false
    skip_concoct                         = false
    skip_prok                            = false
    skip_euk                             = false
}

profiles {
    singularity {
       enabled = true
       autoMounts = true
       cacheDir = params.singularity_cachedir
       registry = 'quay.io'
    }

    ebi {
        params {
            outdir = "GGP_pipeline_results"
            workdir = "/hps/nobackup/rdf/metagenomics/nextflow-jobstore/GGP_pipeline"
            singularity_cachedir = "/hps/nobackup/rdf/metagenomics/singularity_cache_nextflow/"
        }
        workDir = params.workdir

        executor {
            name = "lsf"
            queueSize = 200
        }
        process.cache = "lenient"

        includeConfig 'config/nf_codon.config'
        includeConfig 'config/nf_codon_dbs.config'
        includeConfig 'config/nf_modules.config'
    }

    local {
         docker {
            enabled = true
            autoMounts = true
            registry = 'quay.io'
            userEmulation = true
            runOptions = "--platform linux/x86_64"
        }
        executor {
            name = "local"
            cpus = 2
            memory = '1 GB'
        }

        includeConfig 'config/nf_local.config'
        includeConfig 'config/nf_modules.config'
    }
}
